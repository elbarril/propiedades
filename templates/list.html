{% extends "layout.html" %}

{% block main %}
    {% include "list/search_details.html" %}
    {% include "list/search_banner.html" %}
    
    <ul id="props" class="cards list">
        {% for url,prop in props.items() %}
            <li class="card list-item {% if prop.revised %}active{% endif %} item" id="{{  loop.index  }}">
                <div class="card-content">
                    <div class="list-item-header">
                        <span>{{ prop.title[:80]|default("Sin tÃ­tulo", true) }}{{ "..." if prop.title|length > 79 }}</span>
                    </div>

                    <div class="list-item-content">
                        <img src="{{ prop.image|default(url_for('static', filename='images/property-img-default.gif'), true) }}" alt="{{ prop.title }}">

                        <ul class="list-item-content-data">
                            {% for key, value in prop.data.items() %}
                                <li><strong>{{ key }}:</strong>{{ value }}</li>
                            {% endfor %}
                        </ul>
                        
                        <form class="form comments" action="/{{ name }}/{{ source }}/comment" method="post">
                            <textarea name="comment" rows="3" cols="1" style="width: 100%;">{{ prop.comment }}</textarea>
                            <input type="hidden" name="prop" value="{{ url }}">
                            <input type="hidden" name="list_id" value="{{ loop.index }}">
                            <input class="commentButton" type="submit" value="Comentar" style="float: inline-end;" hidden>
                        </form>
                    </div>
                    
                    <div class="buttons">
                        <a class="button" href="{{ url }}" target="_blank">Abrir</a>

                        <div class="list-item-actions">
                            {% if not prop.rejected %}
                                <form class="form list-item-action" action="/{{ name }}/{{ source }}/{% if prop.revised %}unrevise{% else %}revise{% endif %}" method="post">
                                    <input type="hidden" name="prop" value="{{ url }}">
                                    <input type="hidden" name="list_id" value="{{ loop.index }}">
                                    <input class="button reviseButton {% if prop.revised %}active{% endif %}" type="submit" value="{{ "Revisado" if prop.revised else "Revisar" }}">
                                </form>
                            {% endif %}

                            <form class="form list-item-action" action="/{{ name }}/{{ source }}/{% if prop.rejected %}unreject{% else %}reject{% endif %}" method="post">
                                <input type="hidden" name="prop" value="{{ url }}">
                                <input type="hidden" name="list_id" value="{{ loop.index }}">
                                <input class="button rejectButton {% if prop.rejected %}active{% endif %}" type="submit" value="{{"Restaurar" if prop.rejected else "Rechazar" }}">
                            </form>
                        </div>
                    </div>
                </div>
            </li>
        {% endfor %}
    </ul>
{% endblock main %}